
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Singelton [GoF] - the fancy part of the web</title>
  <meta name="author" content="Tolleiv Nietsch">

  
  <meta name="description" content="Tis pattern is a very well know and a often discussed one. Explaining it the tasty way: let&rsquo;s say you have exactly one well know place where &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tolleiv.github.io/2008/05/singelton-gof">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="the fancy part of the web" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tolleiv.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
  
    
      <h1 class="entry-title">Singelton [GoF]</h1>
    
  
    
      <p class="meta">
        








  


<time datetime="2008-05-23T23:40:00+02:00" pubdate data-updated="true">May 23<span>rd</span>, 2008</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Tis pattern is a very well know and a often discussed one.</p>

<p>Explaining it the tasty way: let&rsquo;s say you have exactly one well know place where you store all your cookies and whenever you need one you can easy point to that place. Normally that&rsquo;s really comfortable because whatever you do with it, you don&rsquo;t have to search some place where you can find a cookie, you just go to that single &ldquo;cookie tin&rdquo; (or wherever you store cookies) and put a new cookie into it ;)</p>

<p>In modern OOP the singleton is not very popular, Eric Evans simple calls it anti-pattern. It makes it much harder to test your software and normally the user of the class, not the class itself, should know how many instances are needed.</p>

<p>But nevertheless for small applications it&rsquo;s very comfortable to use it in some situations and as long as you&rsquo;re also familiar with the drawbacks I think it&rsquo;s ok to consider using it&hellip;.</p>

<p>So the example shows a cookie tin and how to use it and by the way it also implements some kind of lowlevel registry by using the <a href="http://www.php.net/manual/en/language.oop5.magic.php">PHP5 magic methods</a>, but that&rsquo;s another story ;)</p>

<pre><code>/**
* CookieTin a.k.a Singleton object
* we want to force our application
* to hold exactly one CookieTin object
*/
class CookieTin {
    private $_cookies=array();

    /* generic singleton part start*/

    private static $_instance=NULL;
    // prevent instatiation from the outside
    private function __construct() { }

    // prevent cloning
    private function __clone() {}

    public static function getInstance() {
        if(!self::$_instance) {
            self::$_instance = new self();
        }
        return self::$_instance;
    }
    /* generic singleton part end */

    /* registry part start */
    public static function __set($key,Cookie $value) {
        echo “call setter\n”;
        self::$_instance-&gt;_cookies[$key] = $value;
    }

    public static function __get($key) {
        echo “call getter\n”;
        return self::$_instance-&gt;_cookies[$key];
    }

    public static function __isset($key) {
        echo “call isset\n”;
        return isset(self::$_instance-&gt;_cookies[$key]);
    }

    public static function __unset($key) {
        echo “call unset\n”;
        unset(self::$_instance-&gt;_cookies[$key]);
    }
/* registry part end */
}
/**
* Dummy Cookie
*/
class Cookie {
    public $name,$flavor;
}







$tin = CookieTin::getInstance();
if(!isset($tin-&gt;granniescookie)) {
    $tin-&gt;granniescookie = new Cookie();
    $tin-&gt;granniescookie-&gt;name=“Grannies chocolate wonder”;
    $tin-&gt;granniescookie-&gt;flavor=“chocolate”;
}

CookieTin::getInstance()-&gt;granniescookie-&gt;flavor = “chocolte chips”;

var_dump($tin);
unset(CookieTin::getInstance()-&gt;granniescookie);
var_dump($tin);
</code></pre>

<p>The really important things happen in the last lines where the CookieTin is accessed statically and this change also (as you will see yourself) is reflected in the local instance if the $tin.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">tolleiv</span></span>

      








  


<time datetime="2008-05-23T23:40:00+02:00" pubdate data-updated="true">May 23<span>rd</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/anti-pattern/'>anti-pattern</a>, <a class='category' href='/blog/categories/creational/'>creational</a>, <a class='category' href='/blog/categories/registry/'>registry</a>, <a class='category' href='/blog/categories/singleton/'>singleton</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://tolleiv.github.io/2008/05/singelton-gof/" data-via="tolleiv" data-counturl="http://tolleiv.github.io/2008/05/singelton-gof/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2008/05/php-sucks-not-really/" title="Previous Post: PHP sucks? not really!">&laquo; PHP sucks? not really!</a>
      
      
        <a class="basic-alignment right" href="/2008/05/php-fastcgi-vs-php-as-a-module/" title="Next Post: PHP FastCGI vs. PHP as a module">PHP FastCGI vs. PHP as a module &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2013/06/templavoila-followup/">TemplaVoila - followup</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/templavoila-future/">TemplaVoila future</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/genetic-algorithms-boosting-solr/">Using genetic algorithms to optimize Apache Solr boost factors.</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/re-how-to-move-on-typo3/">Re: How to move on? #TYPO3</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/typo3-login-state-and-varnish-cache/">TYPO3 login state and Varnish cache</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/tolleiv">@tolleiv</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'tolleiv',
            count: 1,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Tolleiv Nietsch <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/whiterspace">whiterspace</a>.</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tolleiv';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://tolleiv.github.io/2008/05/singelton-gof/';
        var disqus_url = 'http://tolleiv.github.io/2008/05/singelton-gof/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
