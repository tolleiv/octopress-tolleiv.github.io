
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Plugin [PoEAA] - the fancy part of the web</title>
  <meta name="author" content="Tolleiv Nietsch">

  
  <meta name="description" content="I&rsquo;m sure you&rsquo;re pretty often in the situation that you have to switch something depending on the context you&rsquo;re currently in. For &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tolleiv.github.io/blog/2008/06/05/plugin-poeaa">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="the fancy part of the web" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tolleiv.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
  
    
      <h1 class="entry-title">Plugin [PoEAA]</h1>
    
  
    
      <p class="meta">
        








  


<time datetime="2008-06-05T03:11:00+02:00" pubdate data-updated="true">Jun 5<span>th</span>, 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I&rsquo;m sure you&rsquo;re pretty often in the situation that you have to switch something depending on the context you&rsquo;re currently in. For example most people change their eating habits before summer &ndash; I also do :P</p>

<p>Sometimes this is what you also want to have in your software. To achieve different behaviour you normally just implement two different classes or aggregates and since they have the same &ldquo;meaning&rdquo; they normally share a interface (a.k.a Separated Interface). But who decides which implementation fits into the current environment/context?</p>

<p>The easiest way is to have a Factory Method with a small condition to decide this, but this method might grow very fast if you have various options. In this situation its also a matter of form to move this decision into some kind of configuration(-file) so that there&rsquo;s only on file which differs in various environments.</p>

<p><a href="http://martinfowler.com/eaaCatalog/plugin.html">Martin Fowler</a> suggests to place some kind of mapping into the configuration-file, so that your Factory knows which implementation to instantiate in the current context. The key for the mapping in this case is the name of the Separated Interface.</p>

<p>As you see in the example code below, there are Cookie Tins which create contain Cookies and depending on the current month you want to use a more or less restrictive Cookie Tin. In May, June and July you restrict your application to create max. 5 cookies, the rest of the year you don&rsquo;t care :P</p>

<pre><code>    // The Separated Interface
interface CookieTin {
    public function getCookieInstance();
}

class NormalTin implements CookieTin {
    public function getCookieInstance() {
        return new Cookie();
    }
}

class DietTin implements CookieTin {
    protected $i=0;
    public function getCookieInstance() {
        return ($this-&gt;i++ &lt; 5)?new Cookie():new NullCookie();
    }
}

// The Factory which supports Plugin-Creation
class CookieTinFactory {
    public static function getPlugin( $class ) {
        try {
            return new $GLOBALS['Plugins'][$class]();
        } catch( Exception $e) {
            // maybe call some default implementation if the mapping is wrong
        }
    }
}







class Cookie {
    public function printCalories() {
        echo ’200 ‘;
    }
}

class NullCookie extends Cookie{
    public function printCalories() { }
}







// This is usually in a configuration-file, normally this should
// also sit in a XML structure….

// That’s what it would be in 300 days/year
$GLOBALS['Plugins']['CookieTin'] = “NormalTin”;
// That’s what we have to turn it to before summer
if(in_array(date(‘n’),array(5,6,7))) {
    $GLOBALS['Plugins']['CookieTin'] = “DietTin”;
}

$tin = CookieTinFactory::getPlugin(‘CookieTin’);
$i=10;
while($i–) {
    $cookie = $tin-&gt;getCookieInstance();
    $cookie-&gt;printCalories();
}
</code></pre>

<p>A very common use-case for this is the changed behaviour in a testing-environment compared to the production-environment.
There&rsquo;s something else in the example beside the Plugin Pattern &ndash; I also made use of the Special Case (the NullCookie) pattern  which I&rsquo;m going to show in a future post&hellip;.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">tolleiv</span></span>

      








  


<time datetime="2008-06-05T03:11:00+02:00" pubdate data-updated="true">Jun 5<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/creational/'>creational</a>, <a class='category' href='/blog/categories/factory/'>factory</a>, <a class='category' href='/blog/categories/pattern/'>pattern</a>, <a class='category' href='/blog/categories/plugin/'>plugin</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://tolleiv.github.io/blog/2008/06/05/plugin-poeaa/" data-via="" data-counturl="http://tolleiv.github.io/blog/2008/06/05/plugin-poeaa/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2008/06/02/comparing-php-best-practises/" title="Previous Post: Comparing PHP Best Practises">&laquo; Comparing PHP Best Practises</a>
      
      
        <a class="basic-alignment right" href="/blog/2008/06/07/dunno-why-but-i-love-this-song/" title="Next Post: dunno why but I love this song...">dunno why but I love this song... &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/06/14/templavoila-followup/">TemplaVoila - followup</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/08/templavoila-future/">TemplaVoila future</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/06/genetic-algorithms-boosting-solr/">Using genetic algorithms to optimize Apache Solr boost factors.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/22/re-how-to-move-on-typo3/">Re: How to move on? #TYPO3</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/10/typo3-login-state-and-varnish-cache/">TYPO3 login state and Varnish cache</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Tolleiv Nietsch <br/>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/whiterspace">whiterspace</a>.</span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
